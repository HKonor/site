<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Para Ti ‚ù§Ô∏è</title>

<style>
body{
    margin:0;
    overflow:hidden;
    font-family: Arial, sans-serif;
    background: linear-gradient(to bottom, #8b0000, #ffcccc);
}

#inicio{
    display:flex;
    justify-content:center;
    align-items:center;
    height:100vh;
}

.card{
    background:white;
    padding:30px;
    border-radius:20px;
    text-align:center;
    box-shadow:0 10px 30px rgba(0,0,0,0.3);
}

button{
    padding:12px 25px;
    border:none;
    border-radius:25px;
    background:#ff3366;
    color:white;
    font-size:16px;
    cursor:pointer;
}

#escena{
    display:none;
    width:100%;
    height:100vh;
    position:relative;
}

#treeCanvas{
    position:absolute;
    bottom:0;
    left:50%;
    transform:translateX(-50%);
    transition:left 2s ease;
}

#carta{
    position:absolute;
    right:-450px;
    top:50%;
    transform:translateY(-50%);
    width:380px;
    background:#fff0f5;
    padding:25px;
    border-radius:20px;
    box-shadow:0 10px 30px rgba(0,0,0,0.3);
    transition:right 2s ease;
}

#carta h2{
    color:#cc0066;
}

#contador{
    margin-top:15px;
    color:#cc0066;
    font-weight:bold;
}
</style>
</head>
<body>

<div id="inicio">
    <div class="card">
        <h1>Para Ti ‚ù§Ô∏è</h1>
        <button onclick="iniciar()">Haz clic üíå</button>
    </div>
</div>

<div id="escena">
    <canvas id="treeCanvas"></canvas>

    <div id="carta">
        <h2>Para el amor de mi vida üíñ</h2>
        <p id="mensaje"></p>
        <div id="contador"></div>
    </div>
</div>

<script>

const fechaInicio = new Date("2025-07-19");
const textoCarta = "Si pudiera elegir mil veces, mil veces te volver√≠a a escoger a ti. Gracias por cada momento juntos y gracias por ser paciente conmigo, al igual gracuas por quedarte a mi lado ‚ù§Ô∏è";

const canvas = document.getElementById("treeCanvas");
const ctx = canvas.getContext("2d");

let corazonesCaida = [];
let fondoArbol;

function iniciar(){
    document.getElementById("inicio").style.display="none";
    document.getElementById("escena").style.display="block";

    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    crearArbolEstatico();

    setTimeout(()=>{
        canvas.style.left="25%";
        document.getElementById("carta").style.right="8%";
        escribirCarta();
        actualizarContador();
        setInterval(actualizarContador,1000);
    },2000);

    iniciarCaida();
}

/* üå≥ √Årbol corregido */
function crearArbolEstatico(){

    const offCanvas = document.createElement("canvas");
    offCanvas.width = canvas.width;
    offCanvas.height = canvas.height;
    const octx = offCanvas.getContext("2d");

    const centerX = canvas.width/2;
    const baseY = canvas.height - 60;

    /* Tronco m√°s corto y proporcional */
    let grad = octx.createLinearGradient(centerX-40, baseY-260, centerX+40, baseY);
    grad.addColorStop(0, "#4a2c17");
    grad.addColorStop(1, "#2e1a0f");

    octx.fillStyle = grad;

    octx.beginPath();
    octx.moveTo(centerX-35, baseY);
    octx.lineTo(centerX-20, baseY-260);
    octx.lineTo(centerX+20, baseY-260);
    octx.lineTo(centerX+35, baseY);
    octx.closePath();
    octx.fill();

    /* Ramas conectadas mejor */
    octx.strokeStyle = "#5c3a1e";
    octx.lineWidth = 6;

    function rama(x,y,long,angle,depth){
        if(depth === 0) return;

        let x2 = x + long*Math.cos(angle);
        let y2 = y + long*Math.sin(angle);

        octx.beginPath();
        octx.moveTo(x,y);
        octx.lineTo(x2,y2);
        octx.stroke();

        rama(x2,y2,long*0.7,angle-0.4,depth-1);
        rama(x2,y2,long*0.7,angle+0.4,depth-1);
    }

    rama(centerX, baseY-260, 80, -Math.PI/2, 3);

    /* Copa m√°s natural (no perfectamente redonda) */
    const colores=["#ff3366","#ff4d6d","#ff6699","#ff85a2"];

    for(let i=0;i<450;i++){

        let angle = Math.random() * Math.PI * 2;
        let radiusX = 140 + Math.random()*20;
        let radiusY = 110 + Math.random()*20;

        let x = centerX + Math.cos(angle) * (Math.random()*radiusX);
        let y = (baseY-330) + Math.sin(angle) * (Math.random()*radiusY);

        dibujarCorazon(
            octx,
            x,
            y,
            colores[Math.floor(Math.random()*4)],
            8 + Math.random()*4
        );
    }

    fondoArbol = offCanvas;
    ctx.drawImage(fondoArbol,0,0);
}

function dibujarCorazon(context,x,y,color,size){
    context.fillStyle=color;
    context.beginPath();
    context.moveTo(x,y);
    context.bezierCurveTo(x-size,y-size,x-size*2,y+size/2,x,y+size*2);
    context.bezierCurveTo(x+size*2,y+size/2,x+size,y-size,x,y);
    context.fill();
}

function iniciarCaida(){
    setInterval(()=>{
        corazonesCaida.push({
            x: Math.random()*canvas.width,
            y: -20,
            size: 8 + Math.random()*6,
            speed: 0.4 + Math.random()*0.6,
            color:["#ff3366","#ff4d6d","#ff6699","#ff85a2"]
                [Math.floor(Math.random()*4)]
        });
    },800);

    animar();
}

function animar(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    ctx.drawImage(fondoArbol,0,0);

    corazonesCaida.forEach(c=>{
        c.y += c.speed;
        dibujarCorazon(ctx,c.x,c.y,c.color,c.size);
    });

    corazonesCaida = corazonesCaida.filter(c=>c.y < canvas.height);

    requestAnimationFrame(animar);
}

function escribirCarta(){
    let i=0;
    function escribir(){
        if(i<textoCarta.length){
            document.getElementById("mensaje").innerHTML+=textoCarta.charAt(i);
            i++;
            setTimeout(escribir,30);
        }
    }
    escribir();
}

function actualizarContador(){
    const hoy=new Date();
    const diferencia=hoy-fechaInicio;

    const dias=Math.floor(diferencia/(1000*60*60*24));
    const horas=Math.floor((diferencia/(1000*60*60))%24);
    const minutos=Math.floor((diferencia/(1000*60))%60);
    const segundos=Math.floor((diferencia/1000)%60);

    document.getElementById("contador").innerHTML=
    `${dias} d√≠as ${horas} horas ${minutos} minutos ${segundos} segundos juntos ‚ù§Ô∏è`;
}

</script>

</body>
</html>
